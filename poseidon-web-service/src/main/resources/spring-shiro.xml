<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd"
    default-lazy-init="true">

    <!--<description>Shiro安全配置</description>-->

    <!--<bean class="com.frigga.web.security.shiro.captcha.DreamCaptcha">-->
        <!--<property name="cacheManager" ref="shiroSpringCacheManager"/>-->
        <!--&lt;!&ndash; 复用半小时缓存 &ndash;&gt;-->
        <!--<property name="cacheName" value="halfHour"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash;安全管理器&ndash;&gt;-->
    <!--<bean id="securityManager" class="org.apache.shiro.web.mgt.DefaultWebSecurityManager">-->
        <!--&lt;!&ndash;设置自定义Realm&ndash;&gt;-->
        <!--<property name="realm" ref="shiroDbRealm"/>-->
        <!--&lt;!&ndash;将缓存管理器，交给安全管理器&ndash;&gt;-->
        <!--<property name="cacheManager" ref="shiroSpringCacheManager"/>-->
        <!--&lt;!&ndash; 记住密码管理 &ndash;&gt;-->
        <!--<property name="rememberMeManager" ref="rememberMeManager"/>-->
        <!--<property name="sessionManager" ref="sessionManager"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; 項目自定义的Realm &ndash;&gt;-->
    <!--<bean id="shiroDbRealm" class="com.frigga.web.security.shiro.ShiroDbRealm">-->
        <!--<constructor-arg index="0" name="cacheManager" ref="shiroSpringCacheManager"/>-->
        <!--<constructor-arg index="1" name="matcher" ref="credentialsMatcher"/>-->
        <!--&lt;!&ndash; 启用身份验证缓存，即缓存AuthenticationInfo信息，默认false &ndash;&gt;-->
        <!--<property name="authenticationCachingEnabled" value="true"/>-->
        <!--&lt;!&ndash; 缓存AuthenticationInfo信息的缓存名称 &ndash;&gt;-->
        <!--<property name="authenticationCacheName" value="authenticationCache"/>-->
        <!--&lt;!&ndash; 缓存AuthorizationInfo信息的缓存名称 &ndash;&gt;-->
        <!--<property name="authorizationCacheName" value="authorizationCache"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; 记住密码Cookie &ndash;&gt;-->
    <!--<bean id="rememberMeCookie" class="org.apache.shiro.web.servlet.SimpleCookie">-->
        <!--<constructor-arg value="rememberMe"/>-->
        <!--<property name="httpOnly" value="true"/>-->
        <!--&lt;!&ndash; 7天,采用spring el计算方便修改[细节决定成败]！ &ndash;&gt;-->
        <!--<property name="maxAge" value="#{60 * 60 * 24 * 7}"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; rememberMe管理器,cipherKey生成见{@code Base64Test.java} &ndash;&gt;-->
    <!--<bean id="rememberMeManager" class="org.apache.shiro.web.mgt.CookieRememberMeManager">-->
        <!--<property name="cipherKey" value="#{T(org.apache.shiro.codec.Base64).decode('5aaC5qKm5oqA5pyvAAAAAA==')}"/>-->
        <!--<property name="cookie" ref="rememberMeCookie"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; Shiro Filter &ndash;&gt;-->
    <!--<bean id="shiroFilter" class="org.apache.shiro.spring.web.ShiroFilterFactoryBean">-->
        <!--&lt;!&ndash; 安全管理器 &ndash;&gt;-->
        <!--<property name="securityManager" ref="securityManager"/>-->
        <!--&lt;!&ndash; 默认的登陆访问url &ndash;&gt;-->
        <!--<property name="loginUrl" value="/login"/>-->
        <!--&lt;!&ndash; 登陆成功后跳转的url &ndash;&gt;-->
        <!--<property name="successUrl" value="home"/>-->
        <!--&lt;!&ndash; 没有权限跳转的url &ndash;&gt;-->
        <!--<property name="unauthorizedUrl" value="/login"/>-->
        <!--<property name="filterChainDefinitions">-->
            <!--<value>-->
                <!--&lt;!&ndash;-->
                    <!--anon  不需要认证-->
                    <!--authc 需要认证-->
                    <!--user  验证通过或RememberMe登录的都可以-->
                <!--&ndash;&gt;-->
                <!--/index.jsp =anon-->
                <!--/captcha.jpg = anon-->
                <!--/commons/** = anon-->
                <!--/static/** = anon-->
                <!--/login = anon-->
                <!--/validate = anon-->
                <!--/** = user-->
            <!--</value>-->
        <!--</property>-->
    <!--</bean>-->

    <!--&lt;!&ndash; 用户授权信息Cache, 采用spring-cache, 具体请查看spring-ehcache.xml、spring-redis.xml &ndash;&gt;-->
    <!--<bean id="shiroSpringCacheManager" class="com.frigga.web.security.shiro.cache.ShiroSpringCacheManager">-->
        <!--<property name="cacheManager" ref="cacheManager"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; 会话管理器 &ndash;&gt;-->
    <!--<bean id="sessionManager" class="org.apache.shiro.web.session.mgt.DefaultWebSessionManager">-->
        <!--&lt;!&ndash; 设置全局会话超时时间 半小时 &ndash;&gt;-->
        <!--<property name="globalSessionTimeout" value="#{30 * 60 * 1000}"/>-->
        <!--<property name="sessionDAO" ref="sessionDAO"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; 会话DAO 用于会话的CRUD &ndash;&gt;-->
    <!--<bean id="sessionDAO" class="org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO">-->
        <!--&lt;!&ndash; Session缓存名字，默认就是shiro-activeSessionCache &ndash;&gt;-->
        <!--<property name="activeSessionsCacheName" value="activeSessionCache"/>-->
        <!--<property name="cacheManager" ref="shiroSpringCacheManager"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; 在方法中 注入  securityManager ，进行代理控制 &ndash;&gt;-->
    <!--<bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">-->
        <!--<property name="staticMethod" value="org.apache.shiro.SecurityUtils.setSecurityManager"/>-->
        <!--<property name="arguments" ref="securityManager"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; shiro密码加密配置 &ndash;&gt;-->
    <!--<bean id="passwordHash" class="com.frigga.web.security.shiro.PasswordHash">-->
        <!--&lt;!&ndash; 密码加密 1次md5,增强密码可修改此处 &ndash;&gt;-->
        <!--<property name="algorithmName" value="md5"/>-->
        <!--<property name="hashIterations" value="1"/>-->
    <!--</bean>-->

    <!--&lt;!&ndash; 密码错误5次锁定半小时 &ndash;&gt;-->
    <!--<bean id="credentialsMatcher" class="com.frigga.web.security.shiro.RetryLimitCredentialsMatcher">-->
        <!--<constructor-arg ref="shiroSpringCacheManager"/>-->
        <!--<property name="retryLimitCacheName" value="halfHour"/>-->
        <!--<property name="passwordHash" ref="passwordHash"/>-->
    <!--</bean>-->

</beans>